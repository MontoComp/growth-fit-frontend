<div class="page">
  <div class="header">
    <div class="breadcrumb">
      <span (click)="goToGyms()" class="breadcrumb-item">Gimnasios</span>
      <span class="breadcrumb-separator">/</span>
      <span class="breadcrumb-item active">Clientes</span>
    </div>
    <button class="btn primary" (click)="openModal()">+ Crear cliente</button>
  </div>

  @if(!isLoading()){ @if(clients && clients.length > 0){
  <div #tableContainer class="clients-table-container">
    <div class="fixed-table">
      <table>
        <tr class="sticky header-cell">
          <td class="bolder" [style.width.px]="120">Nombre</td>
        </tr>

        <tr *ngFor="let item of clients">
          <td (click)="goToPayments(item)" class="link">
            {{ item.name }}
          </td>
        </tr>
      </table>
    </div>
    <div class="normal-table">
      <table>
        <tr class="sticky header-cell">
          <td class="bolder" [style.width.px]="120">Email</td>
          <td class="bolder" [style.width.px]="120">TelÃ©fono</td>
          <td class="bolder" [style.width.px]="120">Estado</td>
          <td class="bolder" [style.width.px]="180">Acciones</td>
        </tr>

        <tr *ngFor="let item of clients">
          <td>
            {{ item.email }}
          </td>
          <td>
            {{ item.phone }}
          </td>
          <td>
            <span class="badge" [ngClass]="statusClass(item.status)">
              {{ statusLabel(item) }}
            </span>
          </td>

          <td>
            <button class="btn" (click)="openModal(item)">âœï¸</button>
            <button class="btn danger" (click)="delete(item)">ğŸ—‘ï¸</button>
            <!--<button (click)="viewPayments(c)">ğŸ’°</button>-->
          </td>
        </tr>
      </table>
    </div>
  </div>
  } @else {
  <ng-container [ngTemplateOutlet]="emptyTable"></ng-container>
  } } @else {
  <div class="clients-table-container">
    <div class="fixed-table">
      <table>
        <tr class="sticky header-cell">
          <td class="bolder" [style.width.px]="120">Nombre</td>
        </tr>
        <ng-container
          [ngTemplateOutlet]="loadingTable"
          [ngTemplateOutletContext]="{ totalColumns: 1 }"
        >
        </ng-container>
      </table>
    </div>
    <div class="normal-table">
      <table>
        <tr class="sticky header-cell">
          <td class="bolder" [style.width.px]="120">Email</td>
          <td class="bolder" [style.width.px]="120">TelÃ©fono</td>
          <td class="bolder" [style.width.px]="120">Estado</td>
          <td class="bolder" [style.width.px]="180">Acciones</td>
        </tr>
        <ng-container
          [ngTemplateOutlet]="loadingTable"
          [ngTemplateOutletContext]="{ totalColumns: 4 }"
        >
        </ng-container>
      </table>
    </div>
  </div>
  }
</div>

<ng-template #loadingTable let-totalColumns="totalColumns">
  <tr *ngFor="let tr of getRowsForSkeleton(4)">
    <td *ngFor="let td of getRowsForSkeleton(totalColumns)">
      <nz-skeleton-element
        nzType="input"
        nzSize="small"
        class="skeleton"
        style="width: 100%"
        [nzActive]="true"
      >
      </nz-skeleton-element>
    </td>
  </tr>
</ng-template>

<ng-template #emptyTable>
  <div class="empty-table">
    <span>AÃºn no se han registrado datos en esta secciÃ³n</span>
  </div>
</ng-template>
